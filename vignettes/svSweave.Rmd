---
title: "svSweave - Sweave, Knitr and R Markdown Companion Functions"
author: "Philippe Grosjean (phgrosjean@sciviews.org)"
date: "`r Sys.Date()`"
output:
  rmarkdown::html_vignette:
    fig_caption: yes
vignette: >
  %\VignetteIndexEntry{svMisc - Miscellaneous Functions}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

The 'svSweave' provides different function to better manage Sweave and Knitr with LyX, a document processor that creates LaTeX code. These function are not detailed here. See their help page `?clean_lyx()`.

The package also provides function to automatically enumerate and reference figures, tables and equations in R Markdown documents without needing the 'bookdown' package. Indeed, this feature is missing in the basic R Markdown documents. The various 'bookdown' templates provide a `\@ref(label)`, see [cross-reference](https://bookdown.org/yihui/bookdown/cross-references.html). The various functions `fig()`, `tab()` and `eq()` provide a different mechanism to obtain the same result: enumerated items and the possibility to cross-reference them in the text. Here an example of a numbered figure with its caption. In order to use these function, you must load the 'svSweave' package in a (setup) chunk before you use these functions:

```{r}
library(svSweave)
```

Now, you can use `fig()` to number the caption of a figure in `fig.cap=` (**look at the .Rmd file to see how this is implemented**):

```{r, fig.cap=fig("first-plot", "An example of a simple histogram.")}
hist(rnorm(50))
```

Now, you can reference this plot in the text (see Fig.\ `r fig("first-plot")`). It works also if the first reference appears **before** the figure itself, see Fig.\ `r fig("second-plot")`.

```{r, fig.cap=fig("second-plot", "A second plot as an example.")}
boxplot(rnorm(50))
```

The same principle works for table, for instance, see Table\ `r tab("a-table")`.

```{r}
knitr::kable(head(iris), caption = tab("a-table", "The few first lines of the `iris` dataset."))
```

Finally, numbered equations are constructed and reference in a similar way, but you must specify `""` as second argument where you want to generate the equation number.

`r eq("an-equation", "")` <center>$x=\frac{-b \pm \sqrt{b^2 - 4ac}}{2a}$</center>

... and I can reference eq\ `r eq("an-equation")` like this.

**Enumeration work for now, but it would be fine to have a *link* to the figure too!** To be implemented later on...

> Note that the enumeration are calculated as first arrived-first served. This is the correct order in R MArkdown, but with R Notebooks where you may calculate chunks in a different order, you will end up with a strange succession of the numbers, unless you reset everything!
